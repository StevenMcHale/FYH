{% extends 'main/main.html' %}

{% block content %}





<html>
<head>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }

  .planner {
    display: grid;
    grid-template-columns: 120px repeat(7, 1fr);
    border: 1px solid #ccc;
  }

  .planner div {
    border: 1px solid #ccc;
    padding: 8px;
    box-sizing: border-box;
    text-align: center;
  }

  .meal-label {
    font-weight: bold;
    background: #f3f3f3;
  }

  .day-label {
    font-weight: bold;
    background: #e6e6e6;
  }

  input, select {
    width: 90%;
    padding: 5px;
    font-size: 14px;
    box-sizing: border-box;
  }

  #save-button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 16px;
  }
</style>
</head>
<body>
<h1>Meal Planner</h1>

<!-- ðŸŸ¦ Datalist with meal options -->
<datalist id="meal-options">
  <option value="Pancakes">
  <option value="Omelette">
  <option value="Cereal">
  <option value="Salad">
  <option value="Sandwich">
  <option value="Chicken & Rice">
  <option value="Spaghetti">
  <option value="Stir Fry">
  <option value="Soup">
</datalist>

<div class="planner">

  <!-- Empty top-left corner -->
  <div></div>

  <!-- Days of week -->
  <div class="day-label">Monday</div>
  <div class="day-label">Tuesday</div>
  <div class="day-label">Wednesday</div>
  <div class="day-label">Thursday</div>
  <div class="day-label">Friday</div>
  <div class="day-label">Saturday</div>
  <div class="day-label">Sunday</div>

  <!-- Breakfast row -->
  <div class="meal-label">Breakfast</div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>

  <!-- Lunch row -->
  <div class="meal-label">Lunch</div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>

  <!-- Dinner row -->
  <div class="meal-label">Dinner</div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>
  <div><input list="meal-options"></div>

</div>

<!-- SAVE BUTTON -->
<button id="save-button">Save Meals</button>

<!-- JAVASCRIPT BELOW -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const inputs = document.querySelectorAll("input[list='meal-options']");
    const datalist = document.getElementById("meal-options");

    // Load saved inputs
    if (localStorage.getItem("mealGrid")) {
        const savedMeals = JSON.parse(localStorage.getItem("mealGrid"));
        inputs.forEach((input, index) => {
            if (savedMeals[index]) {
                input.value = savedMeals[index];
            }
        });
    }

    // Load saved meal options
    if (localStorage.getItem("mealOptions")) {
        const savedOptions = JSON.parse(localStorage.getItem("mealOptions"));
        savedOptions.forEach(meal => {
            if (!Array.from(datalist.options).some(opt => opt.value === meal)) {
                let option = document.createElement("option");
                option.value = meal;
                datalist.appendChild(option);
            }
        });
    }

    // SAVE BUTTON CLICK
    document.getElementById("save-button").addEventListener("click", () => {
        let mealValues = [];
        let optionValues = new Set(
            Array.from(datalist.options).map(opt => opt.value)
        );

        inputs.forEach(input => {
            let meal = input.value.trim();
            mealValues.push(meal);

            // Add to dropdown if new
            if (meal !== "" && !optionValues.has(meal)) {
                optionValues.add(meal);
                let option = document.createElement("option");
                option.value = meal;
                datalist.appendChild(option);
            }
        });

        // Save meals
        localStorage.setItem("mealGrid", JSON.stringify(mealValues));

        // Save dropdown options
        localStorage.setItem("mealOptions", JSON.stringify(Array.from(optionValues)));

        alert("Meals saved!");
    });
});
</script>

</body>
</html>

{% endblock %}
